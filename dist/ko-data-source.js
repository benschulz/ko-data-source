/*
 Copyright (c) 2015, Ben Schulz
 License: BSD 3-clause (http://opensource.org/licenses/BSD-3-Clause)
*/
function y(n){var m,w,x,q,r,v,z;m=function(){return function(c){return c}(function(c,b,a,g){return{J:c,Z:b,j:a,va:g}}(function(){function c(a,g){return a&&"function"===typeof a.valueOf&&g&&"function"===typeof g.valueOf?a.valueOf()<=g.valueOf()?a.valueOf()<g.valueOf()?-1:0:1:a<=g?a<g?-1:0:1}function b(a,g){var d=a.length,c=Array(d),b=Array(d),h;for(h=0;h<d;++h)c[h]=h,b[h]=a[h];h=a;a=b;b=h;c.sort(function(e,f){return g(a[e],a[f])||e-f});for(h=0;h<d;++h)b[h]=a[c[h]];return b}return{contains:function(a,
b){return 0<=a.indexOf(b)},qa:function(a,b){return Array.prototype.concat.apply([],a.map(b))},M:function(a,g){var d=g||c;window.chrome?d=b(a,d):(a.sort(d),d=a);return d}}}(),function(){function c(b){return function(){return b}}return{wa:c(!0),pa:c(!1),ta:c(void 0),ua:c(null),xa:c(0),ma:c,$:function(b){return b}}}(),function(){function c(b,a){return Object.prototype.hasOwnProperty.call(b,a)}return{la:function(b,a){return b===a||!(!b||"function"!==typeof b.valueOf||!a||"function"!==typeof a.valueOf||
b.valueOf()!==a.valueOf())},extend:function(b){Array.prototype.slice.call(arguments,1).forEach(function(a){for(var c=Object.keys(a),d=0,l=c.length;d<l;d++){var k=c[d],h=Object.getOwnPropertyDescriptor(a,k);void 0!==h&&h.enumerable&&Object.defineProperty(b,k,h)}});return b},ra:function(b,a){for(var g in b)c(b,g)&&a(g,b[g])},K:c}}(),{na:function(c){return c.replace(/([A-Z])/g,function(b){return"-"+b.toLowerCase()})},oa:function(c){return c.replace(/-([a-z])/g,function(b){return b[1].toUpperCase()})},
format:function(c){var b=arguments;return c.replace(/{(\d+)}/g,function(a,c){var d=parseInt(c,10)+1;return typeof b.length<=d?a:b[d]})}}))}();w=function(c){return function(c){return c}(function(c){function a(a){var k={get length(){return this.length},contains:function(a){return 0<=this.N(a)},filter:function(a){for(var e=[],f=0;f<this.length;++f){var t=this.get(f);a(t,f,this)&&e.push(t)}return new g(e)},forEach:function(a){for(var e=0,f=this.length;e<f;++e)a(this.get(e),e,this)},get:function(a){return this.get(a)},
map:function(a){for(var e=Array(this.length),f=0;f<this.length;++f)e[f]=a(this.get(f),f,this);return new g(e)},readOnly:function(){return new d(this)},slice:function(a,e){var f=this.length;a=0>=arguments.length?0:0<=a?a:f+a;e=1>=arguments.length?f:0<=e?e:f+e;for(var f=e-a,t=Array(f),c=0;c<f;++c)t[c]=this.get(a+c);return new g(t)},k:function(){var a=Array(this.length);this.forEach(function(e,f){a[f]=e});return a},N:function(a){for(var e=0;e<this.length;++e)if(this.get(e)===a)return e;return-1}};return c.j.extend(k,
{get length(){return this.length},contains:k.contains,filter:k.filter,forEach:k.forEach,get:function(a){return this.get(a)},map:k.map,readOnly:k.readOnly,slice:k.slice,toArray:k.k,tryFirstIndexOf:k.N},a)}function g(a){this.A=a}function d(a){this.G=a}g.prototype=a({get length(){return this.A.length},get:function(a){return this.A[a]},k:function(){return this.A.slice()}});d.prototype=a({get length(){return this.G.length},get:function(a){return this.G.get(a)}});return{da:function(a){return new g(a||[])},
ba:a}}(c))}(m);x=function(c,b){return function(a){return a}(function(a,c){function d(a){if("string"!==typeof a)throw Error("Ids must be strings. (given: `"+a+"`, type: `"+typeof a+"`)");return a}function b(e,f){return a.j.K(e,d(f))?e[f]:-1}function k(a,e){var f=b(a,e);if(0>f)throw Error("Es existiert kein Eintrag mit Id '"+e+"'.");return f}function h(a,e,f,c,d){if(c>=d)return c;var b=Math.floor((c+d)/2);return 0>e(f,a[b])?h(a,e,f,c,b):h(a,e,f,b+1,d)}function e(a,e,f,c,d){function b(c,d){var g=h.length,
k=e.slice(c,d);h=h.concat(k);k.forEach(function(e){f[a(e)]=g;++g})}var h=[],g=0;c.forEach(function(a){b(g,a);g=a;d(h)});b(g,e.length);return h}function f(a){this.b=function(e){return d(a(e))};this.elements=[];this.c={};this.f=null}f.prototype=c.ba({get length(){return this.elements.length},get:function(a){return this.elements[a]},sa:function(a){a=k(this.c,a);return this.elements[a]},clear:function(){this.elements=[];this.c={}},contains:function(a){a=(0,this.b)(a);return 0<=b(this.c,a)},V:function(a){return 0<=
b(this.c,a)},W:function(e){var f=this.b,c=this.elements,d=this.c;this.f=e;a.J.M(c,e);e=!1;for(var b=0;b<c.length;++b){var h=f(c[b]);e=e||d[h]!==b;d[h]=b}return e},ha:function(a){if(a.length){var f=this.b,c=this.elements,b=this.c;a=a.map(function(a){return k(b,a)+1});a.sort(function(a,e){return a-e});this.elements=e(f,c,b,a,function(a){a=a.pop();a=f(a);delete b[a]})}},removeAll:function(a){this.ha(a.map(this.b))},O:function(a){if(this.f)throw Error("`updateAll` must not be called on an ordered `IndexedTable`. Use a combination of order-preserving `tryUpdateAll`, `removeAll` and `insertAll` instead.");
if(a.length){var e=this.b,f=this.elements,c=this.c;a.forEach(function(a){var b=k(c,e(a));f[b]=a})}},ia:function(a){if(!this.f)throw Error("`tryUpdateAll` is designed for ordered `IndexedTable`s. For unordered ones, use `updateAll` instead.");if(!a.length)return[];var e=this.b,f=this.elements,c=this.c,b=this.f,d=[];a.forEach(function(a){var h=k(c,e(a));0!==b(a,f[h])?d.push(a):f[h]=a});return d},m:function(e){if(this.f)throw Error("`addAll` must not be called on an ordered `IndexedTable`. Use order-preserving `insertAll` instead.");
if(e.length){var f=this.b,c=this.elements,b=this.c;e.forEach(function(e){var d=f(e);if(a.j.K(b,d))throw Error("The list already contains an element with id `"+d+"`. Did you mean to call `updateAll`?.");b[d]=c.push(e)-1})}},aa:function(f){if(!this.f)throw Error("`insertAll` is designed for ordered `IndexedTable`s. For unordered ones, use `addAll` instead.");if(f.length){var c=this.b,b=this.elements,d=this.c,g=this.f;a.J.M(f,g);var k=0,l=[];f.forEach(function(a){a=h(b,g,a,k,b.length);l.push(a);k=a});
k=0;this.elements=e(c,b,d,l,function(a){var e=f[k],b=c(e),h=a.length;a.push(e);d[b]=h;++k})}}});return f}(b,c))}(w,m);q=function(){function c(c,a,g){this.n=c||[];this.t=a||[];this.s=g||[]}c.prototype={get size(){return this.n.length+this.t.length+this.s.length},get empty(){return!this.size},g:function(c){this.empty||c(this)}};return c}();r={};v=function(c,b,a,g,d){function l(b,d,e){this.parent=b;this.a=d||new a(this.b);this.e=e||c.observable(new g);this.I=c.observable(this.a.readOnly());this.i=null}
l.prototype={get b(){return this.parent.b},get d(){return this.parent.d},get r(){return this.I},get q(){this.i||(this.i=c.observable(this.a.map(this.d.u)));return this.i},get values(){return this.r},get ea(){return this.q},w:function(a){this.I.valueHasMutated();this.i&&(a.n.forEach(this.d.u),this.i(this.a.map(this.d.ca)),a.s.forEach(this.d.v))},F:function(){this.i&&this.a.forEach(this.d.v)},C:function(a){return new d.S(this,a)},D:function(a){return new d.T(this,a)},B:function(a,c){return new d.R(this,
a,c)},dispose:function(){this.dispose()}};Object.defineProperty(l.prototype,"values",{enumerable:!0,get:function(){return this.r}});Object.defineProperty(l.prototype,"observables",{enumerable:!0,get:function(){return this.q}});l.prototype.filteredBy=l.prototype.C;l.prototype.orderedBy=l.prototype.D;l.prototype.clipped=l.prototype.B;return l}(n,m,x,q,r);z=function(c,b,a){function g(c,b,g,h){a.call(this,{b:c,d:b},g,h);this.p=h.subscribe(function(a){this.w(a)}.bind(this))}g.prototype=b.j.extend({},a.prototype,
{dispose:function(){this.p.dispose();this.F()}});return g}(n,m,v);(function(c,b,a,g,d){function l(b,d){g.call(this,b);this.o=c.computed(function(){var e=this.a.k(),f=this.parent.a.filter(c.unwrap(d)).k(),e=new a(f,[],e);this.a.clear();this.a.m(f);this.w(e);e.g(this.e)}.bind(this));this.p=b.e.subscribe(function(e){var f;f=this.b;for(var b=this.a,g=c.unwrap(d),k=e.n.filter(g),l=[],m=e.s.filter(g),n=0,r=e.t.length;n<r;n++){var u=e.t[n],q=b.V(f(u));g(u)?q?l.push(u):k.push(u):q&&m.push(u)}f=new a(k,l,
m);f.empty||(this.a.removeAll(f.s),this.a.O(f.t),this.a.m(f.n),this.w(e),f.g(this.e))}.bind(this))}l.prototype=b.j.extend({},g.prototype,{dispose:function(){this.o.dispose();this.p.dispose();this.F()}});return d.S=l})(n,m,q,v,r);(function(c,b,a,g){function d(b,d){a.call(this,b);this.a.m(b.a.k());this.o=c.computed(function(){this.a.W(c.unwrap(d))&&this.e.valueHasMutated()}.bind(this));this.p=b.e.subscribe(function(a){var e=this.a.ia(a.t);this.a.removeAll(a.s.concat(e));this.a.aa(a.n.concat(e));this.w(a);
this.e.valueHasMutated()}.bind(this))}d.prototype=b.j.extend({},a.prototype,{filteredBy:function(){throw Error("Filtering an ordered view is not supported.");},orderedBy:function(){throw Error("Ordering an ordered view is not supported.");},dispose:function(){this.o.dispose();this.p.dispose();this.F()}});return g.T=d})(n,m,v,r);(function(c,b,a,g){function d(b,d,g){var e=b.d;this.H=e;this.l=c.observable(a.da());this.h=null;var f=b.b;this.o=c.computed(function(){b.e();var a=b.a,p=Math.min(a.length,
c.unwrap(d)),n=Math.min(a.length,p+c.unwrap(g)),m=this.l.peek(),a=a.slice(p,n);a:if(m.length!==a.length)p=!0;else{for(p=m.length-1;0<=p;--p)if(f(m.get(p))!==f(a.get(p))){p=!0;break a}p=!1}p&&(this.l(a),this.h&&(this.h(this.l.peek().map(e.u)),m.forEach(e.v)))}.bind(this))}d.prototype=b.Z.$({get r(){return this.l},get q(){this.h||(this.h=c.observable(this.values().map(this.H.u)));return this.h},get values(){return this.r},get ea(){return this.q},C:function(){throw Error("Filtering a clipped view is not supported.");
},D:function(){throw Error("Ordering a clipped view is not supported.");},B:function(){throw Error("Clipping a clipped view is not supported.");},dispose:function(){this.o.dispose();this.h&&this.l().forEach(this.H.v)}});Object.defineProperty(d.prototype,"values",{enumerable:!0,get:function(){return this.r}});Object.defineProperty(d.prototype,"observables",{enumerable:!0,get:function(){return this.q}});d.prototype.filteredBy=d.prototype.C;d.prototype.orderedBy=d.prototype.D;d.prototype.clipped=d.prototype.B;
d.prototype.dispose=d.prototype.dispose;return g.R=d})(n,m,w,r);return function(c){return c}(function(c,b,a){return{ClientSideDataSource:c,DefaultObservableStateTransitioner:b,ObservableEntries:a}}(function(c,b,a,g,d){return function(b,k){var h=new a(b),e=c.observable(new d);this.openView=this.fa=function(){return new g.U(b,k,h,e)};this.addEntries=function(a){h.m(a);(new d(a)).g(e)};this.updateEntries=function(a){h.O(a);(new d([],a)).g(e);k.P(a)};this.addOrUpdateEntries=function(a){var b=[],c=[];
a.forEach(function(a){(h.contains(a)?c:b).push()});(new d(b,c)).g(e)};this.removeEntries=function(a){h.removeAll(a);(new d([],[],a)).g(e)};this.replaceEntries=function(a){var b=h.k();h.clear();h.m(a);(new d(a,[],b)).g(e);k.P(a)};this.dispose=function(){}}}(n,m,x,{U:z},q),function(c){return function(){var b={};Array.prototype.slice.call(arguments).forEach(function(a){b[a]=!0});this.constructor=function(a){var g={};Object.keys(a).forEach(function(d){g[d]=b[d]?a[d]:c.observable(a[d])});return g};this.Q=
function(a,c){Object.keys(c).filter(function(a){return!b[a]}).forEach(function(b){a[b](c[b])});return a};this.X=function(){}}}(n),function(c){function b(a){this.observable=a;this.ga=c.observable(a);this.L=1}return function(a,g){function d(a){var b=l(a);if(!b)throw Error("Es existierte keine Referenz zum Objekt mit Id '"+a+"' oder es wurden bereits alle freigegeben.");return b}function l(a){if("string"!==typeof a)throw k(a);return Object.prototype.hasOwnProperty.call(h,a)?h[a]:null}function k(a){throw Error("Ids m\u00fcssen Strings sein. Unerwartete Id '"+
a+"' des Typs '"+typeof a+"'.");}g=g||{constructor:function(a){var b={};Object.keys(a).forEach(function(d){b[d]=c.observable(a[d])});return b},Q:function(a,b){Object.keys(b).forEach(function(c){a[c](b[c])});return a},X:function(){}};var h={};this.u=function(c){var d=a(c);if("string"!==typeof d)throw k(d);Object.prototype.hasOwnProperty.call(h,d)?(d=h[d],++d.L):(c=new b(g.constructor(c)),d=h[d]=c);return d.observable};this.v=function(b){b=a(b);0===--d(b).L&&delete h[b]};this.Y=function(a){d(a).ga(null);
delete h[a]};this.ca=function(b){return d(a(b)).observable};this.ka=function(a,b){var c=l(a);c&&b(c.observable)};this.ja=function(b,c){return this.ka(a(b),c)}.bind(this);this.P=function(a){a.forEach(function(a){this.ja(a,function(b){g.Q(b,a)})}.bind(this))}.bind(this);this.dispose=function(){Object.keys(h).forEach(this.Y)}.bind(this)}}(n)))}"function"===typeof define&&define.amd?define(["knockout"],y):window["ko-data-source"]=y(window.ko);
